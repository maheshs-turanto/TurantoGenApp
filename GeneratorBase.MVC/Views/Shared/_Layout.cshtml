@{
	//var entityModel = GeneratorBase.MVC.ModelReflector.Entities;
    DisplayModeProvider.Instance.RequireConsistentDisplayMode = true;
	var currentController = ViewContext.RouteData.Values["controller"].ToString();
    var commonObj = GeneratorBase.MVC.Models.CommonFunction.Instance;
    var AppName = commonObj.AppName();
    var CompanyProfile = commonObj.getCompanyProfile(User);
    var timeoutAlert = commonObj.ApplicationSessionTimeOutAlert();
    var onloadEvent = timeoutAlert == "true" ? "onload=initSession()".ToString() : "";
		string AppUrl = System.Configuration.ConfigurationManager.AppSettings["AppUrl"];
   var url = Url.Content("~/logo/" + CompanyProfile.Icon);
    if (HttpContext.Current != null && HttpContext.Current.Request.Url.Host == "localhost")
    { url = Url.Content("~/logo/" + CompanyProfile.Icon); }
	var AppIcon = url;
    if (!CompanyProfile.Icon.Contains("logo"))
    {
       if (User.CanView("Document"))
        {
            AppIcon = Url.Action("DisplayImageMobile", "Document", new { id = Convert.ToInt64(CompanyProfile.Icon) }) + "?637932252142451897";
        }
        else
        {
            AppIcon = Url.Content("~/logo/logo.gif");
        }
    }
    var AppIconWidth = CompanyProfile.IconWidth == null ? "28px" : CompanyProfile.IconWidth;
    var AppIconHeight = CompanyProfile.IconHeight == null ? "28px" : CompanyProfile.IconHeight;
	var maintenancemode = commonObj.MaintenanceMode().ToLower() == "true" ? true : false;
    var sidebar = EntityDefaultPageHelper.GetLayout((IUser)User, "", "sidebar");
    if (string.IsNullOrEmpty(sidebar)) { sidebar = "_Sidebar"; }
    var topnavbar = EntityDefaultPageHelper.GetLayout((IUser)User, "", "topnavbar");
    if (string.IsNullOrEmpty(topnavbar)) { topnavbar = "_TopNavbar"; }

    bool menudisplay = commonObj.ShowMenuOnTop();
    var marginremove = string.Empty;
    if (menudisplay)
    {
        marginremove = "style=margin-left:0!important;";
    }
} 
<!DOCTYPE html>
<html>
<head>
 @if (commonObj.EnableGoogleAnalytics().ToLower() == "true")
    {
        var trackId = commonObj.TrackingID();
        var customdimensionname = "";
        if (commonObj.CustomDimensionName().ToLower() != "none")
        {
            var customdimensionnameval = commonObj.CustomDimensionName();
            customdimensionname = "ga('create', '" + trackId + "', {'" + customdimensionnameval + "': username});" +
            "ga('set', '&uid', username);" +
            "ga('require', 'displayfeatures');" +
            "ga('set', 'dimension1', username);" +
            "ga('send', 'pageview');";
        }
        else
        {
            customdimensionname = "ga('create', '" + trackId + "', 'auto');" +
                "ga('send', 'pageview');";
        }
        <script>
            var username = '@User.Name';
            (function (i, s, o, g, r, a, m) {
                i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
                    (i[r].q = i[r].q || []).push(arguments)
                }, i[r].l = 1 * new Date(); a = s.createElement(o),
                m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m);
            })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
            @Html.Raw(customdimensionname)
        </script>
    }
    <meta charset="utf-8" />
	    <meta http-equiv="x-ua-compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewBag.Title-@AppName.ToString()</title>
	<link rel="icon" href="~/Content/images/turanto.ico" type="image/x-icon">
    <link rel="shortcut icon" href="~/Content/images/turanto.ico" type="image/x-icon">
    @Styles.Render("~/Content/css")
	@Styles.Render("~/Content/layoutcss")
    @Styles.Render("~/Content/bootstrapcss")
	@Styles.Render("~/Content/Newcss")
	<link href="@Url.Content("~/Content/" + commonObj.getTenantSiteScript(User))" rel="stylesheet" type="text/css" />
    @Styles.Render("~/Content/csstheme")
    @Scripts.Render("~/bundles/modernizr")
	@Scripts.Render("~/bundles/layouttop?637932252142451897")
	   @Scripts.Render("~/bundles/common1?637932252142451897")
	       <!--[if IE 8]>
            <link href="@Url.Content("~/Content/IE8/ie8.css")" rel="stylesheet" type="text/css" />
    <![endif]-->
    <script type="text/javascript">
	 $(document).ready(function () {
        $('input[type=text], textarea,input[type=multiline]').hover(function () {
            $(this).attr("title", $(this).val());
        });

    });
        function cookieExists(name) {
            var nameToFind = name + "=";
            var cookies = document.cookie.split(';');
            for (var i = 0; i < cookies.length; i++) {
                if (cookies[i].trim().indexOf(name) === 0) {
                    var tz = jstz.determine();
                    var storedTimeZone = ($.cookie(name));
                    var currentTimeZone = getTimezoneName();
                    if (storedTimeZone !== currentTimeZone) {
                        document.cookie = "_timezone=" + getTimezoneName() + ";path=/;" + document.cookie; location.reload();
                    }
                    return true;
                }
            }
            return false;
        }
        if (!cookieExists("_timezone")) {
            var tz = jstz.determine();
            document.cookie = "_timezone=" + getTimezoneName() + ";path=/;" + document.cookie;
        }
    </script>
    <script>
		 var isClose = false;
        $(document).ready(function () {
            $(window).resize(responsive);
            $(window).trigger('resize');
			if ('@ViewBag.ApplicationError'.length > 0) {
				//alert('@ViewBag.ApplicationError');
				$("#ErrMsg").text('@ViewBag.ApplicationError');
				$("#ErrMsgQuickAdd").text('@ViewBag.ApplicationError');
				$("#divDisplayCodeFragment").removeAttr("style");
			    $("#divDisplayCodeFragment").html(getMsgTableCodeFragment());
			    $("#ErrmsgtrCodeFragment").text('@ViewBag.ApplicationError');
			}
        });
		$.ajaxSetup({
					beforeSend: function () {
					    $('body').css({ 'cursor': 'wait' })
					},
					complete: function (xhr, status) {
					    $('body').css({ 'cursor': 'default' });
                LoginRequired(xhr.status);
            }
        });
        function LoginRequired(response_data) {
            if (response_data == "400")
                window.location.href = "@Url.Action("Login","Account")";
        }
    </script>
	  <script>
        $(function () {
            $(".limit").each(function (i) {
                len = $(this).text().length;
                if (len > 2) {
                    $(this).text($(this).text().substr(0, 1));
                }
            });
        });
    </script>
	<style>

        #ToppBtn {
            display: none;
            position: fixed;
            bottom: 8px;
            right: 30px;
            z-index: 100;
            font-size: 18px;
            border: none;
            outline: none;
            background-color: #1d5072;
            color: white;
            cursor: pointer;
            padding: 5px 12px;
            border-radius: 4px;
        }

            #ToppBtn:hover {
                background-color: #555;
            }
    
    </style>
 <link href="~/Content/responsive-tabs.css" rel="stylesheet" />
</head>
<body id="@ViewBag.CurrentPage" @onloadEvent >
    @if (commonObj.EnablePrototypingTool() == "true" && User.CanAdd("ApplicationFeedback"))
    {
        var EntName = currentController;
        var PageUrl = commonObj.getBaseForFavoriteUri();
        string actionName = HttpContext.Current.Request.RequestContext.RouteData.Values["action"].ToString();
        var prototypeurl = Url.Action("CreateQuick", "ApplicationFeedback", new { EntityName = EntName, FieldName = "_FieldName", PageName = actionName, UIControlName = "_UIControlName", TS = DateTime.Now });
        <script src="@Url.Content("~/Scripts/PrototypeCommenting.js")" type="text/javascript"></script>
         <script>
            document.onmousedown = function (e) {
                e = e || window.event;
                if (e.which == 3) {
                    PrototypeCommenting('@Html.Raw(prototypeurl)', isClose, e);
                }
            }
        </script>
    }
	 <button onclick="topFunction()" id="ToppBtn" title="Go to top">
            <i class="fas fa-arrow-up"></i> Top
        </button>
	@*div popup window for Quick Add*@
   <div class="modal fade" id="addPopup" tabindex="-1" role="dialog" aria-labelledby="addPopupLabel" aria-hidden="true" data-keyboard="false" data-backdrop="static">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title" id="addPopupLabel">Add EntityName</h4>
                    <button class="close" type="button" aria-label="Close" data-dismiss="modal" aria-hidden="true" onclick="cancelQuickAdd()">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div id="dvPopup">
                </div>
                </div>
            </div>
        </div>
    </div>
	<div class="modal fade" id="PopupBulkOperation" tabindex="-1" role="dialog" aria-labelledby="PopupBulkOperationLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 id="PopupBulkOperationLabel"></h4>
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            </div>
			   <div class="modal-body">
                <div id="dvPopupBulkOperation">
                </div>
				</div>
				<div class="modal-footer">
                <button type="button" id="closePopupBulkOperation" class="btn btn-default btn-sm" data-dismiss="modal" aria-hidden="true">Close</button>
				</div>
        </div>
    </div>
	</div>
	<div class="wrapper">
        <header class="topnavbar-wrapper">
            @if (User != null && User.userroles != null)
                {
                    @Html.Partial(topnavbar, commonObj)
                }
        </header>
        <!-- sidebar-->
        @if (!menudisplay)
        {
        <aside class="aside-container">
            <div class="aside-inner">
                 @if (User != null && User.userroles != null)
            {
                @Html.Partial(sidebar, commonObj)
            }
            </div>
        </aside>
        }
        <!-- offsidebar-->
        <!-- Main section-->
        <section class="section-container" @marginremove>
            <!-- Page content-->
            <div class="content-wrapper">
                @RenderBody()
            </div>
        </section>
        <!-- Page footer-->
        <footer class="footer-container" @marginremove>
            @Html.Partial("_Footer", CompanyProfile)
        </footer>
	</div>
	 @RenderSection("scripts", required: false)
	 <div class="modal fade" id="ShowGraphApplicationFeedback" tabindex="-1" role="dialog" aria-labelledby="ShowGraphApplicationFeedbackLabel" aria-hidden="true">
    <div class="modal-dialog  modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="ShowGraphApplicationFeedbackLabel">Dashboard Application Feedback</h4>
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            </div>
			<div class="modal-body">
            <div id="dvShowGraphApplicationFeedback"  data-url="@Url.Action("ShowGraph", "ApplicationFeedback")">
            </div>
			</div>
        </div>
    </div>
</div>
<div class="modal fade" id="PopupSubmission" tabindex="-1" role="dialog" aria-labelledby="PopupSubmissionLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-primary">
                    <h4 id="PopupSubmissionLabel"></h4>
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true" style="color:white">&times;</button>
                </div>
                <div class="modal-body">
                    <div id="dvPopupSubmission">
                        <h4 class="text-center SubmissionHeader"></h4>
                    </div>
                    <br/>
                    <div class="text-center">
                        <button type="button" id="okPopupSubmission" class="btn btn-primary btn-lg" data-dismiss="modal" aria-hidden="true" style="width:100px" onclick="return true;">Ok</button>
                        <button type="button" id="closePopupSubmission" class="btn btn-default btn-lg" data-dismiss="modal" aria-hidden="true" onlick="return false;" style="width:100px">Close</button>
                    </div>
                </div>
                
            </div>
        </div>
    </div>
	     <div class="modal fade" id="ShowAboutApp" tabindex="-1" role="dialog" aria-labelledby="ShowAboutAppLabel" aria-hidden="true" data-keyboard="false" data-backdrop="static">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title" id="ShowAboutAppLabel">About Application</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                </div>
				<div class="modal-body">
                <div id="dvAboutApp">
				<div class="col-sm-12">
                    @Html.Partial("~/Views/Shared/GenAppInformation.cshtml")
					  </div>
                </div>
				</div>
            </div>
        </div>
    </div>
	 <div class="modal fade" id="quickaddUser" tabindex="-1" role="dialog" aria-labelledby="quickaddUserLabel" aria-hidden="true" data-keyboard="false" data-backdrop="static">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title" id="quickaddUserLabel"> Create User</h4>
                    <button class="close" type="button" data-dismiss="modal" aria-hidden="true" aria-label="Close" onclick="cancelQuickAdd()">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
				<div class="modal-body">
                <div id="dvQAddquickaddUser"  data-url="@Url.Action("CreateUser", "Account")">
                </div>
				</div>
            </div>
        </div>
    </div>
	<div class="modal fade"
         id="addPopupHelp" tabindex="-1" role="dialog" aria-labelledby="addPopupHelpLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                        <h4 class="modal-title" id="addPopupHelpLabel">Properties Help</h4>
					 <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
                <div class="modal-body" id="dvPopupHelp">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-white" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
	<div class="modal fade" id="addPopupHelpUni" tabindex="-1" role="dialog" aria-labelledby="addPopupHelpLabelUni" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
				 <h4 class="modal-title" id="addPopupHelpLabelUni">Help</h4>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                 </div>
                <div class="modal-body">
                    <div id="dvPopupHelpUni"></div>
                </div>
                <div class="modal-footer">
                    <button type="button" id="popHome" class="btn btn-white" onclick="OpenPopUpEntityHelp('addPopupHelpUni', 'dvPopupHelpUni', @Html.Raw("'" + Url.Action("QuickHelp", "PropertyHelpPage") + "'"), 'Home' , '' , '' , 'Home' )">Home</button>
                    <button type="button" class="btn btn-white" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    @Scripts.Render("~/bundles/jqueryval")
	@Scripts.Render("~/bundles/common2?637932252142451897")
    @Scripts.Render("~/bundles/common3?637932252142451897")
	@Scripts.Render("~/bundles/Theme?637932252142451897")
	
	 <script>
        function SetIconForHome(aobj, text) {
            var lis = $("#li" + aobj).find("i").attr('class')
            var spn = "<i class='" + lis + "'></i> <span>" + text + "</span>";
            $("#ahelp" + aobj).html(spn);
            $("#popHome").hide()
        }
    </script>
	@if(User.userroles != null && User.userroles.Count() > 1 && Request.Cookies[AppUrl + "CurrentRole"] == null && currentController != "Home")
    {
        <script>
            ClearFilterCookies();
            var url = '@Url.Action("Index", "Home")';
            window.location.href = url;
        </script>
    }
 @Scripts.Render("~/bundles/layoutbottom?637932252142451897")
    <script type="text/javascript">
        var config = {
            '.chosen-select': {},
            '.chosen-select-deselect': { allow_single_deselect: true },
            '.chosen-select-no-single': { disable_search_threshold: 10 },
            '.chosen-select-no-results': { no_results_text: 'Oops, nothing found!' },
            '.chosen-select-width': { width: "95%" }
        }
        for (var selector in config) {
            $(selector).chosen(config[selector]);
        }
    </script>
<script type="text/javascript">
    var clicked = false;
	document.onkeydown = checkKeycode
    function checkKeycode(e) {
        var keycode;
        if (window.event)
            keycode = window.event.keyCode;
        else if (e)
            keycode = e.which;
        if (keycode == 116) {
            clicked = true;
        }
    }
    function Logout() {
			if (clicked == false)//browser is closed
			{
				var request = GetRequest();
					request.open("GET", "@Url.Action("BrowserClose", "Account")", false);
					request.send();
			}
		}
    function GetRequest() {
        var xmlhttp;
        if (window.XMLHttpRequest) {
            xmlhttp = new XMLHttpRequest();
        }
        else {
            xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
        }
        return xmlhttp;
    }
</script>
	  @if (timeoutAlert == "true")
    {
        var expirationMinutes =commonObj.ApplicationSessionTimeOut();
        <script>
            var sess_expirationMinutes = parseInt(@expirationMinutes)
            var sess_warningMinutes = sess_expirationMinutes - 5;
            var sess_pollInterval = 60000;
            if (sess_expirationMinutes <= 5)
                sess_warningMinutes = sess_expirationMinutes - 1;
        </script>
    }
<script>
    //jQuery('body').on('focus', '.chosen-container-single input', function () {
    //    if (!jQuery(this).closest('.chosen-container').hasClass('chosen-container-active')) {
    //        jQuery(this).closest('.chosen-container').prev().trigger('chosen:open');
    //    }
    //});
        $('.modal-dialog').draggable({
            handle: ".modal-content"
        });
    </script>
	<script type='text/javascript'>
        //ldt customization for auto fill tz dd
        var firstelement = ""
        function SetSameTZAllInDropdown(obj) {
            var val = $(obj).val();
            var valtxt = $("#" + $(obj).attr('id') + ' option:selected').text();
            if (val != "") {
                $(document).find(".TimeZone").find('select').each(function () {
                    if ($(this).attr("id") != $(obj).attr("id")) {
                        //$('#' + $(this).attr('id') + '_chosen').find('input[type=text]').attr("tabindex", "-1");
                        $('#' + $(this).attr('id') + '_chosen').find('input[type=text]').val(valtxt);
                        $(this).trigger('chosen:open');
                        $(this).trigger('click.chosen');
                        $(this).find('option').each(function () {
                            if ($(this).text() == valtxt)
                                $(this).attr('selected', 'selected');
                        });
                        $(this).trigger('chosen:updated')
                    }
                });
            }
            $('#' + $(obj).attr('id') + '_chosen').find('input[type=text]').focus();
        }
    </script>
	 <div id="divProgressSpinner" style="margin: 0px; padding: 0px; position: fixed; right: 0px;
    top: 0px; width: 100%; height: 100%; background-color: #666666; z-index: 30001;
    opacity: .8; filter: alpha(opacity=70);display:none;">
        <p style="position: absolute; top: 20%; left:40%; color: White;font-size:15px; padding:15px;">
            <img src="~/Content/images/loader.gif" style="left: 10%; position: absolute;"
                 height="50" />
            <br />
            <br />
            <br />
            In Progress ...
        </p>
    </div>
	
	 <script>
        //Get the button
        var mybutton = document.getElementById("ToppBtn");

        // When the user scrolls down 20px from the top of the document, show the button
        window.onscroll = function () { scrollFunction() };

        function scrollFunction() {
            if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
                mybutton.style.display = "block";
            } else {
                mybutton.style.display = "none";
            }
        }

        // When the user clicks on the button, scroll to the top of the document
        function topFunction() {
            document.body.scrollTop = 0;
            document.documentElement.scrollTop = 0;
        }
    </script>
<script src="~/Scripts/Common2/responsive-tabs.js"></script>
    <script>
        (function ($) {
            $('.nav-tabs').responsiveTabs();
        })(jQuery);
    </script>
</body>
</html>
@*<script>
    $(document).ajaxStart(function () {
       $("#divProgressSpinner").show();
    });
    $(document).ajaxStop(function () {
        $("#divProgressSpinner").hide();
    });
</script>*@
@if (User.Identity.IsAuthenticated)
{
    <script type="text/javascript">
        $(document).ready(function () {
            if ($("#lnkDefaultDashboard") != undefined) {
                var visibleDefaultDashboard = $("#lnkDefaultDashboard").is(":visible");
                var Url = '@Url.Action("GetDashboardHome", "Home")';
                DashboardHomeShowhide(visibleDefaultDashboard, Url, "lnkDefaultDashboard");
            }
    });
    </script>
}


